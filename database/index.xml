<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Databases on 我的博客</title>
    <link>https://eightyoliveira.github.io/database/</link>
    <description>Recent content in Databases on 我的博客</description>
    <generator>Hugo -- 0.148.2</generator>
    <language>zh-cn</language>
    <lastBuildDate>Mon, 30 Jun 2025 00:00:00 +0000</lastBuildDate>
    <atom:link href="https://eightyoliveira.github.io/database/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>SQL中ON和WHERE条件位置</title>
      <link>https://eightyoliveira.github.io/database/sql%E4%B8%ADon%E5%92%8Cwhere%E6%9D%A1%E4%BB%B6%E4%BD%8D%E7%BD%AE/</link>
      <pubDate>Mon, 30 Jun 2025 00:00:00 +0000</pubDate>
      <guid>https://eightyoliveira.github.io/database/sql%E4%B8%ADon%E5%92%8Cwhere%E6%9D%A1%E4%BB%B6%E4%BD%8D%E7%BD%AE/</guid>
      <description>&lt;h1 id=&#34;业务场景&#34;&gt;业务场景&lt;/h1&gt;
&lt;p&gt;我们有两个表：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;monitor_table&lt;/code&gt;：监控记录表&lt;/li&gt;
&lt;li&gt;&lt;code&gt;admin_table&lt;/code&gt;：管理员信息表&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这两个表通过字段 &lt;code&gt;key_man_name&lt;/code&gt;（监控记录中的负责人）和 &lt;code&gt;name&lt;/code&gt;（管理员姓名）进行关联。&lt;/p&gt;
&lt;p&gt;还有一个逻辑删除标志 &lt;code&gt;del_flag&lt;/code&gt;，表示管理员是否被&amp;quot;软删除&amp;quot;，值为 &amp;lsquo;0&amp;rsquo; 表示有效。&lt;/p&gt;
&lt;h1 id=&#34;查询示例对比&#34;&gt;查询示例对比&lt;/h1&gt;
&lt;h3 id=&#34;示例1条件放在on子句中保留所有左表记录&#34;&gt;示例1：条件放在ON子句中（保留所有左表记录）&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;FROM&lt;/span&gt; monitor_table mt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;LEFT&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;JOIN&lt;/span&gt; admin_table &lt;span style=&#34;color:#66d9ef&#34;&gt;at&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;ON&lt;/span&gt; mt.key_man_name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;at&lt;/span&gt;.name &lt;span style=&#34;color:#66d9ef&#34;&gt;AND&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;at&lt;/span&gt;.del_flag &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;结果：&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;mt.id&lt;/th&gt;
          &lt;th&gt;mt.key_man_name&lt;/th&gt;
          &lt;th&gt;at.name&lt;/th&gt;
          &lt;th&gt;at.del_flag&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;张三&lt;/td&gt;
          &lt;td&gt;张三&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2&lt;/td&gt;
          &lt;td&gt;李四&lt;/td&gt;
          &lt;td&gt;NULL&lt;/td&gt;
          &lt;td&gt;NULL&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;3&lt;/td&gt;
          &lt;td&gt;王五&lt;/td&gt;
          &lt;td&gt;王五&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;解释：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;所有&lt;code&gt;monitor_table&lt;/code&gt;的记录都保留了&lt;/li&gt;
&lt;li&gt;对于李四，因为他在&lt;code&gt;admin_table&lt;/code&gt;中存在但&lt;code&gt;del_flag != &#39;0&#39;&lt;/code&gt;，所以没有匹配上，结果为NULL&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;示例2条件放在where子句中只保留满足条件的记录&#34;&gt;示例2：条件放在WHERE子句中（只保留满足条件的记录）&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;FROM&lt;/span&gt; monitor_table mt
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;LEFT&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;JOIN&lt;/span&gt; admin_table &lt;span style=&#34;color:#66d9ef&#34;&gt;at&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;       &lt;span style=&#34;color:#66d9ef&#34;&gt;ON&lt;/span&gt; mt.key_man_name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;at&lt;/span&gt;.name
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;WHERE&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;at&lt;/span&gt;.del_flag &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;结果：&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;mt.id&lt;/th&gt;
          &lt;th&gt;mt.key_man_name&lt;/th&gt;
          &lt;th&gt;at.name&lt;/th&gt;
          &lt;th&gt;at.del_flag&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;张三&lt;/td&gt;
          &lt;td&gt;张三&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;3&lt;/td&gt;
          &lt;td&gt;王五&lt;/td&gt;
          &lt;td&gt;王五&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;解释：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;李四被过滤掉了，因为&lt;code&gt;at.del_flag = &#39;0&#39;&lt;/code&gt;是在WHERE中判断的，此时at为NULL，不满足条件&lt;/li&gt;
&lt;li&gt;实际效果等同于INNER JOIN&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;关键区别&#34;&gt;关键区别&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ON子句&lt;/strong&gt;：&lt;/p&gt;</description>
    </item>
    <item>
      <title>mysql慢查询优化思路</title>
      <link>https://eightyoliveira.github.io/database/mysql%E6%85%A2%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96%E6%80%9D%E8%B7%AF/</link>
      <pubDate>Thu, 14 Nov 2024 00:00:00 +0000</pubDate>
      <guid>https://eightyoliveira.github.io/database/mysql%E6%85%A2%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96%E6%80%9D%E8%B7%AF/</guid>
      <description>&lt;h1 id=&#34;索引explain&#34;&gt;索引explain&lt;/h1&gt;
&lt;h1 id=&#34;冷热数据备份&#34;&gt;冷热数据备份&lt;/h1&gt;
&lt;h1 id=&#34;宽表&#34;&gt;宽表&lt;/h1&gt;
&lt;h1 id=&#34;内存中做连接&#34;&gt;内存中做连接&lt;/h1&gt;
&lt;h1 id=&#34;分库分表&#34;&gt;分库分表&lt;/h1&gt;
&lt;h1 id=&#34;迁移至分布式数据库&#34;&gt;迁移至分布式数据库&lt;/h1&gt;
&lt;h1 id=&#34;mq迁移数据-查询放到es等olap数据库中-cancel-mq-etl-es&#34;&gt;mq迁移数据 ，查询放到es等olap数据库中( cancel mq etl es)&lt;/h1&gt;
&lt;h1 id=&#34;机器性能-cpu和磁盘io排查&#34;&gt;机器性能 cpu和磁盘io排查&lt;/h1&gt;
&lt;h1 id=&#34;mysql做集群读写分离&#34;&gt;mysql做集群读写分离&lt;/h1&gt;</description>
    </item>
    <item>
      <title>Mysql--对varchar字段用int数值来查询的问题</title>
      <link>https://eightyoliveira.github.io/database/mysql--%E5%AF%B9varchar%E5%AD%97%E6%AE%B5%E7%94%A8int%E6%95%B0%E5%80%BC%E6%9D%A5%E6%9F%A5%E8%AF%A2%E7%9A%84%E9%97%AE%E9%A2%98/</link>
      <pubDate>Sun, 06 Oct 2024 00:00:00 +0000</pubDate>
      <guid>https://eightyoliveira.github.io/database/mysql--%E5%AF%B9varchar%E5%AD%97%E6%AE%B5%E7%94%A8int%E6%95%B0%E5%80%BC%E6%9D%A5%E6%9F%A5%E8%AF%A2%E7%9A%84%E9%97%AE%E9%A2%98/</guid>
      <description>&lt;h1 id=&#34;例子&#34;&gt;例子&lt;/h1&gt;
&lt;p&gt;age是varchar类型&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;select&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;table_name&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt; age&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;1111111111111111111111111111111&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;select&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;table_name&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt; age&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1111111111111111111111111111111&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;如果不加单引号，会查出其他很多无关数据&lt;/p&gt;
&lt;h1 id=&#34;官网原文&#34;&gt;官网原文&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://dev.mysql.com/doc/refman/5.7/en/type-conversion.html&#34;&gt;MySQL :: MySQL 5.7 Reference Manual :: 12.3 Type Conversion in Expression Evaluation&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;从其他copy过来的翻译&lt;/p&gt;
&lt;p&gt;在字符串和数值作比较的时候，字符串和数值都会转换成浮点数进行比较。&lt;/p&gt;
&lt;p&gt;字符串在转浮点数时，如果字符串开头是数字，那就一直截取，直到截取到的不是数字是其他字符为止。若开头不是数字，那么转换数值类型的结果就直接取0。（如’123abc’转成的值是123，&amp;lsquo;ab123’取到的值是0）&lt;/p&gt;
&lt;p&gt;在上述中，我的字符串存储的是18位varchar类型。由于在转换成浮点数的时候，数值太大会自动转换成科学计数法，而且浮点数的精度不准确，都是取近似值，所以会出现意外的内容。也就是说我的查询sql条件在用数值类型时，由于数值太大了，所以在转换成浮点数的时候变成了科学计数法，同理被查询的字段也被转换成了浮点数的科学计数法，又由于浮点数精度的不准确，导致查询结果出现不准确。&lt;/p&gt;
&lt;p&gt;如果用了字符串字段，在查询的时候最好不要用数值（如整数之类的）来查询，因为如果用数值查询，也就是如上面说的，MySql会自动把表达式中的值都转换成浮点数。而这里索引字段varchar类型进行自动转换成了浮点数，导致了索引失效。&lt;/p&gt;
&lt;p&gt;PS:oracle中不会出现这个问题&lt;/p&gt;</description>
    </item>
    <item>
      <title>Mysql（5.7.22）char(1)没notnull和defaultvalue，却强制要求默认值报错</title>
      <link>https://eightyoliveira.github.io/database/mysql5.7.22char1%E6%B2%A1notnull%E5%92%8Cdefaultvalue%E5%8D%B4%E5%BC%BA%E5%88%B6%E8%A6%81%E6%B1%82%E9%BB%98%E8%AE%A4%E5%80%BC%E6%8A%A5%E9%94%99/</link>
      <pubDate>Fri, 20 Sep 2024 00:00:00 +0000</pubDate>
      <guid>https://eightyoliveira.github.io/database/mysql5.7.22char1%E6%B2%A1notnull%E5%92%8Cdefaultvalue%E5%8D%B4%E5%BC%BA%E5%88%B6%E8%A6%81%E6%B1%82%E9%BB%98%E8%AE%A4%E5%80%BC%E6%8A%A5%E9%94%99/</guid>
      <description>&lt;p&gt;解决方案: 把类型改为varchar，成功解决&lt;/p&gt;
&lt;p&gt;原因分析:&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
